<!DOCTYPE HTML>
<head>
  <title>Yagg</title>
  <script type="text/javascript">
    window.onload = function() {
      document.getElementById('joinbutton').onclick = function() {
        const host = document.getElementById('host').value;
        const playername = document.getElementById('name').value;
        const evtSource = new EventSource(`//${host}/sse/game/ID/events?player=${name}`);
        const baseUrl = `http://${host}/game/ID/action?player=${playername}`;  
        const eventDiv = document.getElementById('events');
        evtSource.onmessage = function(event) {
          const newElement = document.createElement('p');
          newElement.innerHTML = 'message: ' + event.data;
          eventDiv.appendChild(newElement);
        }
        function gameaction(actionJson) {
          function listener() {
            console.log(this.responseText);
          }
          var oReq = new XMLHttpRequest();
          oReq.addEventListener('load', listener);
          oReq.open('POST', baseUrl);
          oReq.setRequestHeader('Content-Type', 'application/json');
          oReq.send(JSON.stringify(actionJson));
        }
        gameaction({action: 'join'});
      }
    }
  </script>
</head>
<body>
  <form action="">
    <label for="host">Host</label>
    <input type="text" id="host" name="host" value="localhost:4000"/>
    <label for="name">Name</label>
    <input type="text" id="name" name="name"/>
    <button type="button" id="joinbutton">join</button>
  </form>
  <table id="board" summary="board">
    <tr><td id="c0-4"></td><td id="c1-4"></td><td id="c2-4"></td><td id="c3-4"></td><td id="c4-4"></td>
    <tr><td id="c0-3"></td><td id="c1-3"></td><td id="c2-3"></td><td id="c3-3"></td><td id="c4-3"></td>
    <tr><td id="c0-2"></td><td id="c1-2"></td><td id="c2-2"></td><td id="c3-2"></td><td id="c4-2"></td>
    <tr><td id="c0-1"></td><td id="c1-1"></td><td id="c2-1"></td><td id="c3-1"></td><td id="c4-1"></td>
    <tr><td id="c0-0"></td><td id="c1-0"></td><td id="c2-0"></td><td id="c3-0"></td><td id="c4-0"></td>
  </table>
  <div id="events"></div>
</body>
